{% unless product.price %}    {% assign product = item %}{% endunless %}{% unless product.price %}    {% assign product = qvp %}{% endunless %}{% assign date = 'now' | date: "%s" |plus: 0 %}{% assign affirmed = shop.metafields.pricelock.affirmed %}{% assign diffSeconds = date|minus: affirmed %}{% assign last = diffSeconds | divided_by: 3600 | divided_by: 24 %}{% if last < 2 %}    {% assign has_affirmed = 'yes' %}{% endif %}{% if shop.metafields.pricelock.require_tag_text == nil or shop.metafields.pricelock.require_tag_text == "" or shop.metafields.pricelock.require_tag_text.value == "" %}    {% assign has_tag = 'yes' %}{% else %}    {% assign has_tag = 'no' %}    {% for tag in customer.tags %}        {% if shop.metafields.pricelock.require_tag_text.value == tag %}            {% assign has_tag = 'yes' %}        {% endif %}    {% endfor %}{% endif %}{% assign in_hidden_collect = false %}{% for c in product.collections %}    {% if c.metafields.pricelock.enabled == 1 %}        {% assign in_hidden_collect = true %}    {% endif %}{% endfor %}{% assign hide_product = false %}{% if in_hidden_collect or product.metafields.pricelock.enabled == 1 or shop.metafields.pricelock.hide_all_prices == 1 %}    {% assign hide_product = true %}{% endif %}{% assign customer_is_valid = true %}{% if customer == nil or  has_tag == 'no'  %}    {% assign customer_is_valid = false %}{% endif %}{% if hide_product and has_affirmed and customer_is_valid == false %}    false{% else %}    true{% endif %}